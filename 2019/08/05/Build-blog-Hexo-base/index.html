<!doctype html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo,centos7,node,git,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0">






<meta name="description" content="前言 搭建前提：gitHub账号，域名，服务器（这里我用到的服务器和域名是在阿里云上购买的）。 目的：完成博客站环境的搭建，访问，部署。记录一下在搭建这个博客站点的过程以及遇到的一些问题。">
<meta name="keywords" content="Hexo,centos7,node,git">
<meta property="og:type" content="article">
<meta property="og:title" content="快速使用Hexo搭建个人博客-环境篇">
<meta property="og:url" content="https://www.yuguomin.com/2019/08/05/Build-blog-Hexo-base/index.html">
<meta property="og:site_name" content="SuperFish&#39;s Blog">
<meta property="og:description" content="前言 搭建前提：gitHub账号，域名，服务器（这里我用到的服务器和域名是在阿里云上购买的）。 目的：完成博客站环境的搭建，访问，部署。记录一下在搭建这个博客站点的过程以及遇到的一些问题。">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-download-start.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-download-done.jpg">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-snow.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-set.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-add.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-new.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-input.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-new.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-form.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-init.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-server-cmd.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-server-page.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-new-post.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-new-post-web.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-list.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-reset.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-safe.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-safe.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-input.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-domain.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-add.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-record.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-snow.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/nginx-default-page.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-btn.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-add.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-input.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-err.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-server-start.png">
<meta property="og:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-test.png">
<meta property="og:updated_time" content="2019-12-18T07:29:12.561Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="快速使用Hexo搭建个人博客-环境篇">
<meta name="twitter:description" content="前言 搭建前提：gitHub账号，域名，服务器（这里我用到的服务器和域名是在阿里云上购买的）。 目的：完成博客站环境的搭建，访问，部署。记录一下在搭建这个博客站点的过程以及遇到的一些问题。">
<meta name="twitter:image" content="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-download-start.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.yuguomin.com/2019/08/05/Build-blog-Hexo-base/">





<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #3385ff; /*进度条颜色*/
        height: 3px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #3385ff, 0 0 5px #3385ff; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #3385ff;    /*上边框颜色*/
        border-left-color: #3385ff;    /*左边框颜色*/
    }
</style>

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>
  <title> 快速使用Hexo搭建个人博客-环境篇 | SuperFish's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">
  <a href="https://github.com/yuguomin/blog-web"><img style="position:absolute;top:0;left:0;border:0;z-index:1;" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_left_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SuperFish's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">day day up~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://www.yuguomin.com/2019/08/05/Build-blog-Hexo-base/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="YGM">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://cdn.yuguomin.com/images/common/test-smile.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SuperFish's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                快速使用Hexo搭建个人博客-环境篇
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-05T23:22:21+08:00">
                2019-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hexo/" itemprop="url" rel="index">
                    <span itemprop="name">Hexo</span>
                  </a>
                </span>

                
                
              
            </span>
          
          
            
          

          
          
          <span class="post-time">
            &nbsp; | &nbsp;
                  <span class="post-meta-item-icon">
                    <i class="fa fa-calendar-o"></i>
                  </span>
                  <span class="post-meta-item-text">字数统计:</span>
                  <span class="post-count">5.4k(字)</span>
                </span>
            
              <span class="post-time">
            &nbsp; | &nbsp;
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">阅读时长:</span>
            <span class="post-count">20(分)</span>
            
          </span>

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv">
            Visitors<span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul>
<li>搭建前提：gitHub账号，域名，服务器（这里我用到的服务器和域名是在阿里云上购买的）。</li>
<li>目的：完成博客站环境的搭建，访问，部署。记录一下在搭建这个博客站点的过程以及遇到的一些问题。</li>
</ul>
<a id="more"></a> 
<ul>
<li>大致流程:<br>本地环境配置 =&gt; 服务器环境配置 =&gt; 配置webhook同步代码</li>
<li>使用到的相关环境版本<br>local OS: macOS Mojave 10.14.5<br>server OS: CentOS7.4.1708<br>hexo: 3.9.0<br>nvm: 0.34.0<br>Node.js: 8.11.4<br>npm: 5.6.0<br>git: 2.18.0<br>pm2: 3.5.1</li>
</ul>
<hr>
<h1 id="本地环境配置"><a href="#本地环境配置" class="headerlink" title="本地环境配置"></a>本地环境配置</h1><p>本地配置包括: Node.js, git, Hexo</p>
<h2 id="安装Node-js"><a href="#安装Node-js" class="headerlink" title="安装Node.js"></a>安装Node.js</h2><p><font id="install-node-server"><strong>这里安装node的方法同样适用于centOS7服务端</strong></font><br><a href="https://nodejs.org/zh-cn/docs/" target="_blank" rel="noopener">node.js</a>是一个后端的JavaScript运行环境，拥有它，就可以编写系统级或者服务器端的 Javascript 代码，交给node去解释执行。为什么要装node？Hexo本身就是一个JS框架，里面有很多JS脚本，需要node环境去执行。<br>这里使用的是安装nvm管理node版本的方式，所以先安装nvm<br><a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener">nvm</a>是针对node产生的一个版本控制工具，使用它可以下载和切换不同版本的node。<br><a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a>是一种包管理工具，通过npm可以安装各种在npm上传的工具包。在安装node的时候npm会同时安装。后面会需要使用npm安装如hexo等工具。</p>
<h3 id="安装nvm"><a href="#安装nvm" class="headerlink" title="安装nvm"></a>安装nvm</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash</span><br></pre></td></tr></table></figure>

<p>使用上面的命令运行安装nvm，安装完成后需要重新执行全局变量文件才可以使用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>

<p>在输入完成后输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm</span><br></pre></td></tr></table></figure>

<p>会收到 Node Version Manager, 即为成功。<br>如果有提示找不到nvm命令或者没有.bash_profile文件，可以手动添加环境变量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi ~/.bash_profile</span><br></pre></td></tr></table></figure>

<p>把这一段内容加入到文件中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$HOME/.nvm&quot;</span><br><span class="line">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;</span><br></pre></td></tr></table></figure>

<p>保存之后再次执行一次</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>

<h3 id="通过nvm安装node-js"><a href="#通过nvm安装node-js" class="headerlink" title="通过nvm安装node.js"></a>通过nvm安装node.js</h3><p>在安装完毕nvm并配置好环境变量后，就可以通过nvm控制node版本。<br>查看node版本列表命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm list-remote</span><br></pre></td></tr></table></figure>

<p>可以选择任意一个需要的版本去安装，我这里使用的是v8.11.4，使用安装命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install v8.11.4</span><br></pre></td></tr></table></figure>

<p>可以通过nvm命令查看已经安装的node版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm list</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-&gt;  v8.11.4</span><br><span class="line">      system</span><br></pre></td></tr></table></figure>

<p>可以通过nvm命令去切换成想要使用的版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm use v8.11.4</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Now using node v8.11.4</span><br></pre></td></tr></table></figure>

<p>将此版本设置为默认版本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm alias default v8.11.4</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">default -&gt; v8.11.4</span><br></pre></td></tr></table></figure>

<p>通过命令验证是否安装成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node --version</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v8.11.4</span><br></pre></td></tr></table></figure>

<p>验证npm的安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm -v</span><br></pre></td></tr></table></figure>

<p>得到输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5.6.0</span><br></pre></td></tr></table></figure>

<h2 id="git安装"><a href="#git安装" class="headerlink" title="git安装"></a>git安装</h2><p>git是一个分布式版本控制系统，简单点说就是可以远端存储代码，并且多端协同开发同步代码的系统。<br>安装git的目的，通过git的hooks进行本地和服务器的代码同步，部署发布。<br>安装方法来自<a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git" target="_blank" rel="noopener">git官方文档</a></p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>安装Git的最简单方法是安装Git附带的Xcode命令行工具。在Mavericks（10.9）或更高版本上，只需尝试从终端运行git命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure>

<p>如果未安装git会提示，阅读并同意协议，安装即可使用。已安装会提示版本信息。</p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>在该地址<a href="https://git-scm.com/download/mac" target="_blank" rel="noopener">git官方下载地址</a>下载git<br>下载完成后打开文件进行安装即可。<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-download-start.png" width="60%" style="margin:0;"><br>完成<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-download-done.jpg" width="60%" style="margin:0;"><br>再次使用 git –version 进行确认</p>
<h3 id="配置git-ssh"><a href="#配置git-ssh" class="headerlink" title="配置git ssh"></a>配置git ssh</h3><p>做好ssh的配置目的是为了之后部署好代码，上传时不需要每次都输入用户名密码。<a href="https://help.github.com/cn/articles/connecting-to-github-with-ssh" target="_blank" rel="noopener">官方文档</a><br>第一次需要配置你的user name和email</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "xxxxxx" # 自行替换</span><br><span class="line">git config --global user.email "xxxxxx@xx.com" # 自行替换</span><br></pre></td></tr></table></figure>

<p>执行生成密钥命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C "your_email@example.com" # 替需要换为你的 GitHub 电子邮件地址</span><br></pre></td></tr></table></figure>

<p>然后一路默认Enter即可，直到出来下面的雪花图<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-snow.png" width="50%" style="margin:0;"><br>此时~/.ssh文件夹下就会生成id_rsa（私有秘钥）和id_rsa.pub（公有密钥），将公钥复制带粘贴板</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pbcopy &lt; ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>

<p><font id="config-git"><strong>拿到生成号的公钥，现在需要进入git官网对账户进行设置，这一步在之后服务端配置git也会用到</strong></font><br>下一步打开github账号，点击右上角小头像，选择setting入口<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-set.png" width="40%" style="margin:0;"><br>点击左侧边栏的SSH and GPG keys（SSH 和 GPG 密钥）选项<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-add.png" width="40%" style="margin:0;"><br>然后点击New SSH key（新 SSH 密钥）或 Add SSH key（添加 SSH 密钥）<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-new.png" width="60%" style="margin:0;"><br>“Title” 标题中写入一个标示，提示下你这个ssh的用处，然后把刚才复制的内容粘贴到 “Key”（密钥）中<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-input.png" width="60%" style="margin:0;"><br>完成后点击下面的 Add SSH key（添加 SSH 密钥）按钮，如有提示输入密码按要求输入即可<br>测试下是否配置成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p>将会看到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The authenticity of host &apos;github.com (207.97.227.239)&apos; can&apos;t be established.</span><br><span class="line">    RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.</span><br><span class="line">    Are you sure you want to continue connecting (yes/no)?</span><br></pre></td></tr></table></figure>

<p>输入回程或者yes，收到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi xxxxxx! You&apos;ve successfully authenticated, but GitHub does not provide bash access.</span><br></pre></td></tr></table></figure>

<p>完成配置～</p>
<h3 id="新建一个git仓库"><a href="#新建一个git仓库" class="headerlink" title="新建一个git仓库"></a>新建一个git仓库</h3><p>git账号和本地ssh配对完成，那么就新建一个仓库，用于之后保存博客站的代码。<br>同样 点击刚才设置时的小头像，选择<strong>your repositories</strong> 然后选择点击 New按钮<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-new.png" width="60%" style="margin:0;"><br>点击之后会看到一个仓库详情填写<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-form.png" width="70%" style="margin:0;"><br>Repository name（仓库名）填对应的你想要的仓库名<br>Description（描述）是对于项目的描述<br>Public和Private一般使用默认Public就可以了<br>Initialize this repository with a README（是否需要初始化一个README文件？）这里可以初始化也可以不初始化，我一般不初始化，仓库上传时会写一个<br>然后点击底部 create repository 按钮即可完成创建<br><img id="ssh-url" src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-rep-init.png" width="70%" style="margin:0;"><br><font color="red" size="3"><strong>这里的ssh地址在之后配置hexo的发布时是需要用到的</strong></font><br>完成创建</p>
<h2 id="Hexo安装"><a href="#Hexo安装" class="headerlink" title="Hexo安装"></a>Hexo安装</h2><p>Hexo是一个博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章生成静态网页。并且有方便的发布系统和各种插件。<br>这里主要是安装hexo-cli及如何生成博客的基本模版，<font color="red" size="3"><strong>确保安装Hexo时已经安装node和git</strong></font></p>
<h3 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h3><p>这里使用npm在全局安装hexo-cli</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g hexo-cli</span><br></pre></td></tr></table></figure>

<p>安装完毕已经可以使用hexo命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure>

<h3 id="使用hexo"><a href="#使用hexo" class="headerlink" title="使用hexo"></a>使用hexo</h3><p>hexo已经安装成功了，那么接下来需要的是在本地创建一个hexo的代码库<br>进入一个文件夹，执行命令在当前文件夹生成网站所需要的文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<p>安装代码仓库所需要的第依赖包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>安装成功之后，就可以执行命令本地启动预览页面效果了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generate # 也可以简写hexo g，效果相同，生成public文件夹下的静态文件</span><br><span class="line">hexo server # 也可以简写hexo s，效果相同，在本地启动一个访问服务</span><br></pre></td></tr></table></figure>

<img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-server-cmd.png" width="60%" style="margin:0;">
点击 http://localhost:4000 打开页面，可以看到一个hexo的模版效果
<img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-server-page.png" width="60%" style="margin:0;">
回到命令行使用命令
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post &quot;first blog&quot; # 注意标题中有空格需要用双引号包起来</span><br></pre></td></tr></table></figure>

<p>此时会在source/_post路径下创建一个first-blog.md文件，有对应的标题和生成时间。<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-new-post.png" width="60%" style="margin:0;"><br>再刷新一下刚才本地服务启动打开的页面，可以看到一篇新的文章已经生成<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hexo-new-post-web.png" width="60%" style="margin:0;"><br>通过对md文件进行修改就可以编写博客啦～<br>上面在创建新文章的命令，使用的是new post代表新建文章,也可以new page代表新建页面，new draft代表草稿。</p>
<h3 id="配置hexo的发布"><a href="#配置hexo的发布" class="headerlink" title="配置hexo的发布"></a>配置hexo的发布</h3><p>每一次hexo g之后生成的public代码，我们需要把它同步到git上，然后再通过git webhooks同步到服务器<br>此时需要先安装hexo的git部署插件，在我们的hexo项目打开终端，输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<p>打开项目下的<font color="red" size="3"><strong>_config.yml文件，该文件是整个站点的配置文件</strong></font>，在文件的最下方，修改deploy配置，这里需要用的之前生成的<a href="#ssh-url">ssh地址</a></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="string">git@github.com:your_name/blog-web.git</span> <span class="comment"># 替换为刚才新建git代码库的ssh链接 </span></span><br><span class="line"><span class="attr">  branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<p>完成了这一步后，就可以执行我们本地与git的同步了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g # 清楚本来的打包代码并生成出新的</span><br><span class="line">hexo d # hexo deploy的简写命令</span><br></pre></td></tr></table></figure>

<p>这个时候就会完成代码往git库的master分支的代码上传，只会上传public文件夹下的内容，刷新一下对应git代码仓库页面，就看到了最新上传内容。<br><strong>hexo的一些主题配置和一些其他使用方法将在之后的博客中写，本篇只讲环境配置快速搭建</strong></p>
<h1 id="服务器环境配置"><a href="#服务器环境配置" class="headerlink" title="服务器环境配置"></a>服务器环境配置</h1><p>配置流程: 阿里云相关配置 =&gt; 链接服务器环境配置 =&gt; 配置git-webhooks</p>
<h2 id="阿里云配置"><a href="#阿里云配置" class="headerlink" title="阿里云配置"></a>阿里云配置</h2><p>这里我使用的是阿里云的域名(<a href="https://beian.aliyun.com/?spm=a2c4g.11186623.s_lxkr2z.18.2cf97bfeZ2bIPx" target="_blank" rel="noopener">需要备案</a>)和服务器(CentOS7)，域名后面可以免费申请ssl证书(配置https),这里先用http</p>
<h3 id="阿里云的服务器配置"><a href="#阿里云的服务器配置" class="headerlink" title="阿里云的服务器配置"></a>阿里云的服务器配置</h3><p>进入阿里云官网控制台，选择左边导航的 云服务器 ECS，找不到就搜索一下, 然后点击实例查看你的服务器列表<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-list.png" width="60%" style="margin:0;"><br>选择对应的服务器后面的更多选项 =&gt; 密码/密钥 =&gt; 重置实例密码 =&gt; <strong>输入你想设置的实例登录密码</strong> =&gt; 提交<br><img id="ali-reset" src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-reset.png" width="60%" style="margin:0;"><br>记住这里的服务器ip一栏下的公网ip =&gt; 选择左侧导航安全组 =&gt; 点击对应服务器的安全组的配置规则<br><img id="ali-set-safe" src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-safe.png" width="60%" style="margin:0;"><br>点击添加安全组规则<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-safe.png" width="60%" style="margin:0;"><br>这里填写端口范围 80/80，即开放的端口，80端口如果在列表里有就不用加，授权对象 0.0.0.0/0 即允许任意公网IP地址连接实例，描述可以写一点备注信息 =&gt; 确定<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-input.png" width="60%" style="margin:0;"><br>然后按照刚才的流程，把 9001/9001，443/443，也加进去，授权对象仍是 0.0.0.0/0<br>这里完成里之后登陆访问服务器，以及端口暴露，仅在服务器内部处理防火墙是不够的，阿里云服务器安全组这里也要允许</p>
<h3 id="阿里云的域名配置"><a href="#阿里云的域名配置" class="headerlink" title="阿里云的域名配置"></a>阿里云的域名配置</h3><p>点击左边导航栏，前往域名区域 =&gt; 找到对应域名 =&gt; 点击解析<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-domain.png" width="60%" style="margin:0;"><br>选择域名的解析设置<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-add.png" width="60%" style="margin:0;"><br>选择添加记录 =&gt; 修改主机记录 添加www =&gt; 修改记录值为刚才的服务器公网ip =&gt; 确定<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/ali-server-record.png" width="60%" style="margin:0;"><br>这一步，相当于把 www.(你的域名) 解析到里你的服务器，除了www你还可以配置其他，这里建议不要随便把记录值写成别的非阿里云或非中国大陆及香港服务器，不然小心备案被取消需要重新备案～</p>
<h2 id="服务端环境配置"><a href="#服务端环境配置" class="headerlink" title="服务端环境配置"></a>服务端环境配置</h2><p>这里是<strong>CentOS7</strong><br>流程：安装及配置相关环境，Nginx、node、PM2、git<br>打开终端 输入ssh 命令链接 </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@实例的(弹性)公网IP # 替换为网站的公网ip</span><br></pre></td></tr></table></figure>

<p><a href="#ali-reset">输入设置的实例登陆密码</a><br>收到  Welcome to Alibaba Cloud Elastic Compute Service ! 登陆成功</p>
<h3 id="安装Node-js-1"><a href="#安装Node-js-1" class="headerlink" title="安装Node.js"></a>安装Node.js</h3><p>这里CentOS与macOS的node安装方法相同，同样我选择使用的是nvm安装。<a href="#install-node-server">点击跳转安装方法</a></p>
<h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><p>同样，我们需要在服务端同步我们存储在git上的代码，因此我们需要在服务端也安装及配置好git。<br>使用yum CentOS的本地包管理器来搜索和安装gitCentOS存储库中提供的最新包，这是安装的最快方式，但这种安装方式安装的版本可能不是最新版本，如果需要最新版本，请考虑git从源代码编译，这里就不介绍了，<a href="https://www.digitalocean.com/community/tutorials/how-to-install-git-on-centos-7" target="_blank" rel="noopener">详细git安装方法</a>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install git</span><br></pre></td></tr></table></figure>

<p>命令正确无误的执行过后，可以尝试执行命令查看版本确认安装成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br></pre></td></tr></table></figure>

<p>出现对应安装的版本号，安装完毕，进行配置git，这里的配置主要还是ssh<br>配置你的user name和email</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "xxxxxx" # 自行替换</span><br><span class="line">git config --global user.email "xxxxxx@xx.com" # 自行替换</span><br></pre></td></tr></table></figure>

<p>执行生成密钥命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096 -C "your_email@example.com" # 替需要换为你的 GitHub 电子邮件地址</span><br></pre></td></tr></table></figure>

<p>然后一路默认Enter即可，直到出来下面的雪花图<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/git-ssh-snow.png" width="50%" style="margin:0;"><br>此时~/.ssh文件夹下就会生成id_rsa（私有秘钥）和id_rsa.pub（公有密钥），将公钥复制带粘贴板</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh</span><br><span class="line">cat id_rsa.pub</span><br></pre></td></tr></table></figure>

<p>把文件内容复制，之后将这端ssh配置到你的git账户，<a href="#config-git">流程与在本地配置时相同。</a></p>
<p><font id="config-rep-server">配置已经完成后，这个时候我们需要去把对应代码库拉取到服务端，我新建一个专门用于存放代码的文件夹</font><br>下面在拉取代码时需要之前申请的<a href="#ssh-url">git仓库地址</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /</span><br><span class="line">mkdir www # 用于存放业务代码</span><br><span class="line">mkdir frontend # 用于存放前端代码</span><br><span class="line">git clone git@github.com:yourname/blog-web.git # 自行替换为用于存放博客代码的仓库ssh地址</span><br></pre></td></tr></table></figure>

<p>现在，我们完成了git的安装及代码库的部署，但是现在代码只是暂时同步了当前仓库的最新内容，但是如果有人在本地推送新的代码上去，服务端需要</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull # git代码拉取命令</span><br></pre></td></tr></table></figure>

<p>才能拉取到最新代码，这种人为更新是非常耗费时间的一件事，后面我们将使用webhooks进行自动更新服务端代码。</p>
<h3 id="安装及配置Nginx"><a href="#安装及配置Nginx" class="headerlink" title="安装及配置Nginx"></a>安装及配置Nginx</h3><p>Nginx，是一款web服务器/反向代理服务器以及电子邮件代理服务器。这里使用Nginx就是为了配置反向代理，实现页面访问。<br>安装CentOS 7 EPEL存储库，EPEL存储库相当于为系统安装一个第三方包源，其中会有一些常用的工具包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install epel-release</span><br></pre></td></tr></table></figure>

<p>接下来在服务器上安装Nginx存储库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install nginx</span><br></pre></td></tr></table></figure>

<p>问题回答 y，Nginx将在虚拟专用服务器（VPS）上完成安装。<br>安装完毕需要启动Nginx<br>sudo systemctl start nginx<br>刚买的服务器默认是没有开启防火墙的，所以这一块不用处理<br>这个时候在浏览器中输入你的公网ip打开就可以看到nginx的默认页面<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/nginx-default-page.png" width="50%" style="margin:0;"><br>这是启动nginx后按照它的默认配置导向了预制好的一个静态页面，看到这个页面说明Nginx的安装已经没问题。<br>这个时候设置一下系统启用自动启用nginx</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable nginx</span><br></pre></td></tr></table></figure>

<p>nginx安装已经ok，并且打开了默认的ngxin页面，但是我们最终的目的是通过我们配置的<a href="#阿里云的域名配置">阿里云域名</a>直接访问到部署的<a href="#config-rep-server">博客站的代码</a>，那么我们需要去配置一下ngxin，找到我们默认的nginx配置文件，默认地址是’/etc/nginx/nginx.conf’，也可以通过命令查看文件路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t # 这个命令实际作用是用来测试配置文件</span><br></pre></td></tr></table></figure>

<p>默认会显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf test is successful</span><br></pre></td></tr></table></figure>

<p>开始修改配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/nginx/nginx.conf # nginx的配置文件路径</span><br></pre></td></tr></table></figure>

<p>我们需要配置的是80端口访问到博客站内容，找到对应设置<font color="red">80</font>的sever，替换为下面这一段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  www.yuguomin.com; # 购买的域名</span><br><span class="line">	  root /www/frontend/blog-web; # 在服务端的代码路径</span><br><span class="line">        include /etc/nginx/default.d/*.conf;</span><br><span class="line">        location / &#123;</span><br><span class="line">          root /www/frontend/blog-web;</span><br><span class="line">          index index.jsp index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>完成后保存，重启nginx</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart nginx</span><br></pre></td></tr></table></figure>

<p>在浏览器，打开购买的域名地址，注意这个时候<font color="red"><strong>只能使用http协议地址</strong></font><br>如果访问有问题，请确认你的nginx配置，<a href="#阿里云配置">阿里云域名及服务器配置</a>，确保域名指向和安全组配置，防火墙配置。<br>完成了这些配置之后，我们就可以在浏览器通过购买的域名打开部署在服务器上的博客站代码。</p>
<h3 id="安装pm2"><a href="#安装pm2" class="headerlink" title="安装pm2"></a>安装pm2</h3><p><a href="http://pm2.keymetrics.io/docs/usage/quick-start/" target="_blank" rel="noopener">pm2</a>是node的守护进程管理器，这里安装pm2是为了后面在使用git webhooks时创建的服务进行维护</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g pm2 # npm 在装node时已经自动安装</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pm2 -v # 查看pm2版本</span><br></pre></td></tr></table></figure>

<p>安装成功后，可以通过pm2的命令去守护node进程，重启，全局管理，收集打印等。<br>常用命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pm2 start &lt;path&gt; # 执行对应路径脚本</span><br><span class="line">pm2 list # 查看看起的进程列表</span><br><span class="line">pm2 restart &lt;name|id&gt; # 重启对应进程</span><br><span class="line">pm2 delete &lt;name|id|'all'&gt; # 删除对应的进程 all是全部</span><br><span class="line">pm2 logs # 查看进程打印日志</span><br><span class="line">pm2 monit # 监控每个 node 进程的 cpu 和内存使用情况</span><br></pre></td></tr></table></figure>

<h1 id="配置webhooks"><a href="#配置webhooks" class="headerlink" title="配置webhooks"></a>配置webhooks</h1><p><a href="https://developer.github.com/webhooks/" target="_blank" rel="noopener">git webhooks</a>是可以设置通过git仓库的各种触发事件，通过post请求到对应的服务,通过对这个服务的监听可以做一些拉取代码等操作。<br>这里我们需要配置的功能是每一次当我们将博客站代码推送到git，git会通过webhooks请求服务端的接口，触发代码的更新，保证服务端代码对git的同步。即每次我们上传代码到git，服务端自动去拉取代码，浏览器访问时就是最新的代码。</p>
<h2 id="配置仓库的webhook"><a href="#配置仓库的webhook" class="headerlink" title="配置仓库的webhook"></a>配置仓库的webhook</h2><p>打开在git上的代码库页面，点击setting<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-btn.png" width="60%" style="margin:0;"><br>点击左边选项的WebHooks，然后点击Add webhook<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-add.png" width="60%" style="margin:0;"><br>这里需要设置一下webhook<br>Payload URL 写入 公网ip + 9001端口， 这里的作用是当触发这个webhook的时候会往这个地址发送一个post请求，这里是将这个请求服务放在了9001端口上。<br>Content type 改为application/json<br>Secert 设置一段密码，一会会用到<br>Which events would you like to trigger this webhook? 默认的 Just the push event. 就可以，仅push代码时触发。<br>Active 勾选起来<br>然后点击Add webhook<br><img id="input-hook" src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-input.png" width="60%" style="margin:0;"><br>这个时候我们可以看到Webhooks列表中多了一条，点击后面的Edit(编辑)<br>拉到底部，这个时候看到一个报错，点击报错后面三个点<br><img id="hook-edit" src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-err.png" width="60%" style="margin:0;"><br>报错是服务器超时，因为我们并没有设置在服务器端的监听</p>
<h2 id="服务器端的端口监听"><a href="#服务器端的端口监听" class="headerlink" title="服务器端的端口监听"></a>服务器端的端口监听</h2><p>ssh链接登陆服务器，创建一个用于存放webhooks的文件夹</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir NodeWebhooks</span><br><span class="line">vi webhook.js # 写入服务</span><br></pre></td></tr></table></figure>

<p>第一行代码写入对应仓库webhook设置的<a href="#input-hook">Secert</a>，第二行是服务端对应存放博客站代码的路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secret = <span class="string">"your_secret_here"</span>;</span><br><span class="line"><span class="keyword">const</span> repo = <span class="string">"/www/frontend/blog-web"</span>;</span><br></pre></td></tr></table></figure>

<p>然后引入 http 和 crypto 用来创建web服务器和通过特定算法进行内容比较</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br></pre></td></tr></table></figure>

<p>引入 child_process.exec ，用于执行 shell 脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br></pre></td></tr></table></figure>

<p>接下来，添加代码以定义处理GitHub webhook的请求，通过校验后，则拉取博客站最新版本的代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    req.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> sig = <span class="string">"sha1="</span> + crypto.createHmac(<span class="string">'sha1'</span>, secret).update(chunk.toString()).digest(<span class="string">'hex'</span>);</span><br><span class="line">        <span class="keyword">if</span> (req.headers[<span class="string">'x-hub-signature'</span>] == sig) &#123;</span><br><span class="line">          exec(<span class="string">'cd '</span> + repo + <span class="string">' &amp;&amp; git pull'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	        <span class="built_in">console</span>.log(<span class="string">'err:'</span>, <span class="string">'signature'</span>, req.headers[<span class="string">'x-hub-signature'</span>], <span class="string">'sig'</span>, sig, <span class="string">'time:'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;).listen(<span class="number">9001</span>);</span><br></pre></td></tr></table></figure>

<p>这个http.createServer()函数在端口上启动Web服务器，9001是之前我们已经在阿里云服务器安全组及git端加入的端口，通过监听这个端口的请求，我们验证请求中包含的secret与我们在git端设置的是否匹配，如果请求是可信的，就执行shell命令，拉取最新的代码。<br><strong>完整脚本如下</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secret = <span class="string">"your_secret_here"</span>;</span><br><span class="line"><span class="keyword">const</span> repo = <span class="string">"/www/frontend/blog-web"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">"crypto"</span>);</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">'child_process'</span>).exec;</span><br><span class="line"></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">    req.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> sig = <span class="string">"sha1="</span> + crypto.createHmac(<span class="string">'sha1'</span>, secret).update(chunk.toString()).digest(<span class="string">'hex'</span>);</span><br><span class="line">        <span class="keyword">if</span> (req.headers[<span class="string">'x-hub-signature'</span>] == sig) &#123;</span><br><span class="line">          exec(<span class="string">'cd '</span> + repo + <span class="string">' &amp;&amp; git pull'</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	        <span class="built_in">console</span>.log(<span class="string">'err:'</span>, <span class="string">'signature'</span>, req.headers[<span class="string">'x-hub-signature'</span>], <span class="string">'sig'</span>, sig, <span class="string">'time:'</span>, <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">        &#125;);</span><br><span class="line">    res.end();</span><br><span class="line">&#125;).listen(<span class="number">9001</span>);</span><br></pre></td></tr></table></figure>

<p>完成了脚本，那么使用pm2开启这个服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pm2 start ./webhook.js</span><br><span class="line">pm2 list # 查看开启的进程列表</span><br></pre></td></tr></table></figure>

<img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-server-start.png" width="60%" style="margin:0;">
可以看到刚才开启的进程已经出现在列表中，如果没有其他进程，这个时候的id是0，可以通过一些常用pm2命令进行操作
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pm2 restart 0 # 重启这个id为0的服务</span><br><span class="line">pm2 logs 0 # 查看这个id为0的服务打印日志</span><br><span class="line">pm2 delete 0 # 删除这个服务</span><br></pre></td></tr></table></figure>

<h2 id="测试webhooks"><a href="#测试webhooks" class="headerlink" title="测试webhooks"></a>测试webhooks</h2><p>在博客站的git代码库，<a href="#hook-edit">编辑对应的webhook</a>，点击三个点后，点击 Redeliver<br><img src="https://cdn.yuguomin.com/images/Build-blog-hexp-base/hook-set-test.png" width="60%" style="margin:0;"><br>再次发送请求，确认要发送请求，将看到成功的响应200 OK。<br>这个时候整个webhooks配置完毕。</p>
<h1 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h1><p>完成了之前的配置，我们现在整体有一个效果</p>
<ul>
<li>通过本地的hexo开发写入博客内容，利用hexo的发布将代码发布到git</li>
<li>git通过webhook请求服务端</li>
<li>服务端接收到通知拉取最新的博客站代码</li>
<li>浏览器输入购买的域名，访问到最新的博客站代码</li>
</ul>
<p>相对于博客站的开发，环境配置方面已经完成，关于hexo的主题细节配置，及阿里云https申请，图片的cdn访问见之后的博客。<br><strong>谢谢～</strong></p>

      
    </div>
    <div>
      
        <div style="text-align:center;color: #ccc;font-size:14px;">---------------- The End ----------------</div>
        

      
    </div>

    <div>
      
        

      
    </div>
  <div>
        <p id="div-border-left-red">
      <b>本文基于<a target="_blank" title="Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)" href="http://creativecommons.org/licenses/by-sa/4.0/"> 知识共享署名-相同方式共享 4.0 </a>国际许可协议发布</b><br>
        <span>
        <b>本文地址: </b><a href="/2019/08/05/Build-blog-Hexo-base/" title="快速使用Hexo搭建个人博客-环境篇">https://www.yuguomin.com/2019/08/05/Build-blog-Hexo-base/</a><br><b>转载请注明出处, 谢谢！</b>
        </span>
        </p>
  </div>
    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Hexo/" rel="tag"><i class="fa fa-tag"> Hexo</i></a>
          
            <a href="/tags/centos7/" rel="tag"><i class="fa fa-tag"> centos7</i></a>
          
            <a href="/tags/node/" rel="tag"><i class="fa fa-tag"> node</i></a>
          
            <a href="/tags/git/" rel="tag"><i class="fa fa-tag"> git</i></a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/12/What-is-BFC/" rel="prev" title="CSS-BFC">
                CSS-BFC <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!--MOB SHARE BEGIN-->
<div class="-hoofoo-share-title">分享到: </div>
<div class="-hoofoo-share-buttons">
    <div class="-mob-share-weibo -hoofoo-share-weibo -hoofoo-share-ui-button"><i class="fa fa-weibo" aria-hidden="true"></i></div>
    <div class="-mob-share-weixin -hoofoo-share-weixin -hoofoo-share-ui-button"><i class="fa fa-weixin" aria-hidden="true"></i></div>
    <div class="-mob-share-qq -hoofoo-share-qq -hoofoo-share-ui-button"><i class="fa fa-qq" aria-hidden="true"></i></div>
    <div class="-mob-share-twitter -hoofoo-share-twitter -hoofoo-share-ui-button"><i class="fa fa-twitter" aria-hidden="true"></i></div>
    <div class="-hoofoo-share-more -hoofoo-share-ui-button -mob-share-open"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></div>
</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-tencentweibo"><p>腾讯微博</p></li>
        <li class="-mob-share-renren"><p>人人网</p></li>
        <li class="-mob-share-kaixin"><p>开心网</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-pengyou"><p>朋友网</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>Linkedin</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=2bee37e5c8594"></script>
<!--MOB SHARE END-->
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NTk4MC8yMjQ5MQ=="></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://cdn.yuguomin.com/images/common/test-smile.jpg" alt="YGM">
          <p class="site-author-name" itemprop="name">YGM</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        
<div id="days"></div>
    <script>
    function show_date_time(){
        window.setTimeout("show_date_time()", 1000);
        BirthDay=new Date("08/03/2019 12:34:56");
        today=new Date();
        timeold=(today.getTime()-BirthDay.getTime());
        sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
        msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
        e_hrsold=(e_daysold-daysold)*24;
        hrsold=setzero(Math.floor(e_hrsold));
        e_minsold=(e_hrsold-hrsold)*60;
        minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
        seconds=setzero(Math.floor((e_minsold-minsold)*60));
        document.getElementById('days').innerHTML="已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
    }
function setzero(i){
    if (i<10)
    {i="0" + i};
    return i;
}
show_date_time();
</script>

      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#本地环境配置"><span class="nav-number">2.</span> <span class="nav-text">本地环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装Node-js"><span class="nav-number">2.1.</span> <span class="nav-text">安装Node.js</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装nvm"><span class="nav-number">2.1.1.</span> <span class="nav-text">安装nvm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过nvm安装node-js"><span class="nav-number">2.1.2.</span> <span class="nav-text">通过nvm安装node.js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#git安装"><span class="nav-number">2.2.</span> <span class="nav-text">git安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方法一"><span class="nav-number">2.2.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法二"><span class="nav-number">2.2.2.</span> <span class="nav-text">方法二</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置git-ssh"><span class="nav-number">2.2.3.</span> <span class="nav-text">配置git ssh</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#新建一个git仓库"><span class="nav-number">2.2.4.</span> <span class="nav-text">新建一个git仓库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hexo安装"><span class="nav-number">2.3.</span> <span class="nav-text">Hexo安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装方法"><span class="nav-number">2.3.1.</span> <span class="nav-text">安装方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用hexo"><span class="nav-number">2.3.2.</span> <span class="nav-text">使用hexo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置hexo的发布"><span class="nav-number">2.3.3.</span> <span class="nav-text">配置hexo的发布</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#服务器环境配置"><span class="nav-number">3.</span> <span class="nav-text">服务器环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#阿里云配置"><span class="nav-number">3.1.</span> <span class="nav-text">阿里云配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#阿里云的服务器配置"><span class="nav-number">3.1.1.</span> <span class="nav-text">阿里云的服务器配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#阿里云的域名配置"><span class="nav-number">3.1.2.</span> <span class="nav-text">阿里云的域名配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务端环境配置"><span class="nav-number">3.2.</span> <span class="nav-text">服务端环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装Node-js-1"><span class="nav-number">3.2.1.</span> <span class="nav-text">安装Node.js</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装git"><span class="nav-number">3.2.2.</span> <span class="nav-text">安装git</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装及配置Nginx"><span class="nav-number">3.2.3.</span> <span class="nav-text">安装及配置Nginx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装pm2"><span class="nav-number">3.2.4.</span> <span class="nav-text">安装pm2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置webhooks"><span class="nav-number">4.</span> <span class="nav-text">配置webhooks</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#配置仓库的webhook"><span class="nav-number">4.1.</span> <span class="nav-text">配置仓库的webhook</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务器端的端口监听"><span class="nav-number">4.2.</span> <span class="nav-text">服务器端的端口监听</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试webhooks"><span class="nav-number">4.3.</span> <span class="nav-text">测试webhooks</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#结果"><span class="nav-number">5.</span> <span class="nav-text">结果</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YGM</span>
</div>


<div class="powered-by">
   个人专属
</div>

<div class="theme-info">
  博客 - Super fish
</div>


        

<div class="busuanzi-count">

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  




  
      <script type="text/javascript">
        (function(d, s) {
          var j, e = d.getElementsByTagName(s)[0];
          if (typeof LivereTower === 'function') { return; }
          j = d.createElement(s);
          j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
          j.async = true;
          e.parentNode.insertBefore(j, e);
        })(document, 'script');
    </script>
  


  
  

  

  

  

  


  

  
<script type="text/javascript">
    //微信二维码点击背景关闭
    $('body').delegate('.-mob-share-weixin-qrcode-bg','click', function(){
         $(".-mob-share-weixin-qrcode-close").trigger("click");
    }); 
</script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"superSample":2,"width":160,"height":160,"position":"left"},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.5},"log":false});</script></body>

<script type="text/javascript">
  if (window.screen.width > 750) {
    var canvasScript = document.createElement("script");
    canvasScript.setAttribute("type", "text/javascript");
    canvasScript.setAttribute("src", "/lib/canvas-nest/canvas-nest.min.js");
    canvasScript.setAttribute("color", '255,0,204');
    canvasScript.setAttribute("opacity", '0.5');
    canvasScript.setAttribute("zIndex", '-2');
    canvasScript.setAttribute("count", '40');
    document.body.appendChild(canvasScript);
  }
</script>

</html>
